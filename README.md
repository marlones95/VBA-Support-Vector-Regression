# VBA-Support-Vector-Regression
This repository contains MATLAB code for analyzing fMRI data using support vector regression (SVR) in a delayed-match-to-comparison task, as part of the study: "Effector-Dependent Neural Representations of Perceptual Decisions Independent of Motor Actions and Sensory Modalities" (Esmeyer et al.).
The primary goal of the analysis is to investigate effector-dependent neural representations of perceptual decisions. 
Thereby, perceptual decisions (f1 > f2 or f1 < f2) are modelled by the integration of two subjective frequency distributions, which reflect noisy realizations of f1 and f2. To account for the Fechner’s law (Fechner, 1860) frequencies were log-transformed. In addition, the model accounts for the TOE (i.e. contraction bias), which is a commonly found bias in DMTC tasks (Ashourian & Loewenstein, 2011; Pennock et al., 2021; Saarela et al., 2023). The TOE refers to the phenomenon that the mnemonic representation of stimuli tends to regress towards the average of the stimulus set. The Bayesian inference model accounts for the TOE by combining the noisy distribution of the log-transformed f1 (likelihood distribution) with a distribution centred around the mean of a-priori observed log stimuli frequencies (prior distribution) to obtain a posterior distribution (f1’) which is shifted towards the mean of the overall stimulus set (Ashourian & Loewenstein, 2011; Boboeva et al., 2024). Thus, during the decision the subjective, mean-shifted posterior f1’ was compared to the noisy distribution of the log-transformed f2, leading to distinct performance patterns depending on stimulus order and frequency of f1 (f2 is not retained and thus not combined with the prior distribution).
We included 3 free parameters in our model. (1) The variance of the likelihood distribution σ²stim to model the individual’s perceptual precision (1/σ²stim) across all stimulus frequencies. A smaller σ²stim indicated a less noisy perception of the stimulus frequencies. (2) The variance of the prior distribution σ²prior, which models the precision of the prior (1/σ²prior). A higher precision of the prior amplifies the influence of the stimulus mean and thus increases the TOE. (3) The response bias b indicates the participants tendency to prefer f1 > f2 over f1 < f2 or vice versa. These three model parameters were estimated for each participant individually by minimizing the variational free energy in a variational Bayes scheme, as implemented in the VBA toolbox (Daunizeau et al., 2014). 

To quantify if the model with all three parameters (“full model”) provided the most accurate explanation for the behavioural data, we employed Bayesian model selection (BMS; Stephan et al., 2009) to compare it to a set of plausible alternative models. Our three comparison models included the “simple model” incorporating only σ²stim as a free parameter, the “biased simple model” incorporating σ²stim and b as free parameter, and the “unbiased TOE model” incorporating σ²prior and σ²stim as free parameters. In the applied BMS, models were regarded as random effects that could differ between subjects as implemented in the VBA toolbox (Daunizeau et al., 2014) and the variational free energy was used to select the best model (i.e. the model which occurs most frequently in the data set). By punishing for the inclusion of additional parameters, the variational free energy inherently accounts for model complexity and thereby avoids overfitting.

We used the individually estimated measures for the perceptual precision and the TOE to calculate SFDs of all 8 stimulus pairs by subtracting the posterior means of f1’ and f2. Since the means had to be subtracted in different orders, depending on the two varying comparison directions, a total of 16 SFD values (8 stimulus pairs * 2 comparison directions) were extracted for each participant. The SFDs were used to model the strength of the decision (i.e. the subjective decision values) in the subsequent fMRI decoding analysis.
